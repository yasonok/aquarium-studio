<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è³¼ç‰©è»Š - Aquarium Studio</title>
  <link rel="stylesheet" href="css/style.css">
  <style>
    .checkout-section {
      background: white;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }
    
    .checkout-section h3 {
      font-size: 1.1rem;
      margin-bottom: 15px;
      color: #333;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .form-row-2 {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    
    .form-row-3 {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 10px;
    }
    
    .form-group {
      margin-bottom: 12px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 5px;
      color: #666;
      font-size: 0.9rem;
    }
    
    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 12px;
      border: 2px solid #e1e5eb;
      border-radius: 8px;
      font-size: 1rem;
      transition: border-color 0.3s;
    }
    
    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: #667eea;
    }
    
    .option-card {
      display: block;
      padding: 15px;
      border: 2px solid #e1e5eb;
      border-radius: 10px;
      margin-bottom: 10px;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .option-card:hover {
      border-color: #667eea;
      background: #f8faff;
    }
    
    .option-card.selected {
      border-color: #667eea;
      background: #f0f4ff;
    }
    
    .option-card .option-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 600;
    }
    
    .option-card .option-desc {
      font-size: 0.85rem;
      color: #666;
      margin-top: 5px;
    }
    
    .option-card .option-price {
      font-weight: bold;
      color: #667eea;
    }
    
    .payment-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
    }
    
    .payment-btn {
      padding: 15px;
      border: 2px solid #e1e5eb;
      border-radius: 10px;
      background: white;
      cursor: pointer;
      text-align: center;
      transition: all 0.3s;
    }
    
    .payment-btn:hover {
      border-color: #667eea;
    }
    
    .payment-btn.selected {
      border-color: #667eea;
      background: #f0f4ff;
    }
    
    .payment-btn .icon {
      font-size: 1.5rem;
      margin-bottom: 5px;
    }
    
    .payment-btn .name {
      font-weight: 600;
      font-size: 0.9rem;
    }
    
    .order-summary-card {
      background: #f8f9fa;
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 15px;
    }
    
    .order-summary-card h4 {
      margin-bottom: 10px;
      font-size: 1rem;
    }
    
    .order-item-row {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px solid #e1e5eb;
    }
    
    .order-item-row:last-child {
      border-bottom: none;
    }
    
    .order-total-row {
      display: flex;
      justify-content: space-between;
      padding: 12px 0;
      border-top: 2px solid #667eea;
      margin-top: 10px;
      font-weight: bold;
      font-size: 1.1rem;
    }
    
    .step-indicator {
      display: flex;
      justify-content: center;
      margin-bottom: 30px;
    }
    
    .step {
      display: flex;
      align-items: center;
      color: #999;
    }
    
    .step.active {
      color: #667eea;
    }
    
    .step-number {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background: #e1e5eb;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      margin-right: 8px;
    }
    
    .step.active .step-number {
      background: #667eea;
      color: white;
    }
    
    .step-line {
      width: 50px;
      height: 2px;
      background: #e1e5eb;
      margin: 0 10px;
    }
    
    .step.active .step-line {
      background: #667eea;
    }
    
    .city-selector {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-bottom: 10px;
    }
    
    .city-btn {
      padding: 10px;
      border: 2px solid #e1e5eb;
      border-radius: 8px;
      background: white;
      cursor: pointer;
      text-align: center;
      font-size: 0.9rem;
    }
    
    .city-btn.selected {
      border-color: #667eea;
      background: #f0f4ff;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="container">
      <div class="header-inner">
        <a href="index.html" class="logo">
          <span class="logo-icon">ğŸŸ</span>
          <span class="logo-text">Aquarium <span>Studio</span></span>
        </a>
        
        <nav class="nav-links">
          <a href="index.html">é¦–é </a>
          <a href="shop.html">å•†åº—</a>
          <a href="cart.html" class="active">ğŸ›’ è³¼ç‰©è»Š</a>
          <a href="login.html">ğŸ‘¤ æœƒå“¡</a>
        </nav>
        
        <button class="mobile-menu-btn" onclick="toggleMobileMenu()">â˜°</button>
      </div>
    </div>
  </header>

  <!-- Checkout Section -->
  <section class="section">
    <div class="container">
      <!-- Step Indicator -->
      <div class="step-indicator">
        <div class="step active">
          <span class="step-number">1</span>
          <span>å¡«å¯«è³‡æ–™</span>
        </div>
        <div class="step-line"></div>
        <div class="step">
          <span class="step-number">2</span>
          <span>ç¢ºèªè¨‚å–®</span>
        </div>
      </div>
      
      <div class="cart-container">
        <!-- Cart Items -->
        <div class="checkout-section">
          <h3>ğŸ“¦ è¨‚å–®å•†å“</h3>
          <div id="checkout-items">
            <div class="spinner"></div>
          </div>
        </div>
        
        <!-- Customer Info -->
        <div class="checkout-section">
          <h3>ğŸ‘¤ è³¼è²·äººè³‡è¨Š</h3>
          
          <div class="form-group">
            <label>å§“å *</label>
            <input type="text" id="customer-name" placeholder="è«‹è¼¸å…¥æ‚¨çš„å§“å" required>
          </div>
          
          <div class="form-group">
            <label>é€£çµ¡é›»è©± *</label>
            <input type="tel" id="customer-phone" placeholder="0912-345-678" required>
            <small style="color: #999; font-size: 0.8rem;">å®…é…äººå“¡å°‡ä»¥æ­¤é›»è©±è¯ç¹«</small>
          </div>
          
          <div class="form-group">
            <label>LINE ID</label>
            <input type="text" id="customer-lineid" placeholder="@yasonok02061">
          </div>
          
          <div class="form-group">
            <label>é€è²¨åœ°å€ *</label>
            <div class="city-selector">
              <select id="customer-city" onchange="updateDistricts()">
                <option value="">é¸æ“‡ç¸£å¸‚</option>
                <option value="å°åŒ—å¸‚">å°åŒ—å¸‚</option>
                <option value="æ–°åŒ—å¸‚">æ–°åŒ—å¸‚</option>
                <option value="æ¡ƒåœ’å¸‚">æ¡ƒåœ’å¸‚</option>
                <option value="å°ä¸­å¸‚">å°ä¸­å¸‚</option>
                <option value="å°å—å¸‚">å°å—å¸‚</option>
                <option value="é«˜é›„å¸‚">é«˜é›„å¸‚</option>
                <option value="åŸºéš†å¸‚">åŸºéš†å¸‚</option>
                <option value="æ–°ç«¹å¸‚">æ–°ç«¹å¸‚</option>
                <option value="å˜‰ç¾©å¸‚">å˜‰ç¾©å¸‚</option>
                <option value="æ–°ç«¹ç¸£">æ–°ç«¹ç¸£</option>
                <option value="è‹—æ —ç¸£">è‹—æ —ç¸£</option>
                <option value="å½°åŒ–ç¸£">å½°åŒ–ç¸£</option>
                <option value="å—æŠ•ç¸£">å—æŠ•ç¸£</option>
                <option value="é›²æ—ç¸£">é›²æ—ç¸£</option>
                <option value="å±æ±ç¸£">å±æ±ç¸£</option>
                <option value="å®œè˜­ç¸£">å®œè˜­ç¸£</option>
                <option value="èŠ±è“®ç¸£">èŠ±è“®ç¸£</option>
                <option value="å°æ±ç¸£">å°æ±ç¸£</option>
                <option value="æ¾æ¹–ç¸£">æ¾æ¹–ç¸£</option>
                <option value="é‡‘é–€ç¸£">é‡‘é–€ç¸£</option>
                <option value="é€£æ±Ÿç¸£">é€£æ±Ÿç¸£</option>
              </select>
              <select id="customer-district">
                <option value="">é¸æ“‡é„‰é®å¸‚å€</option>
              </select>
            </div>
            <input type="text" id="customer-address" placeholder="è·¯/å··/å¼„/è™Ÿ/æ¨“" style="margin-top: 10px;" required>
          </div>
          
          <div class="form-group">
            <label>éƒµéå€è™Ÿ</label>
            <input type="text" id="customer-zipcode" placeholder="100" readonly>
          </div>
        </div>
        
        <!-- Shipping Method -->
        <div class="checkout-section">
          <h3>ğŸšš é…é€æ–¹å¼</h3>
          
          <div class="option-card selected" onclick="selectShipping('blackcat-prepay', 200)">
            <div class="option-header">
              <span>ğŸ± é»‘è²“å®…æ€¥ä¾¿ - å…ˆä»˜æ¬¾</span>
              <span class="option-price">$200</span>
            </div>
            <div class="option-desc">æœ‰è³¼è²·æ´»é«”è«‹é¸æ­¤é¸é …</div>
          </div>
          
          <div class="option-card" onclick="selectShipping('blackcat-cod', 250)">
            <div class="option-header">
              <span>ğŸ± é»‘è²“å®…æ€¥ä¾¿ - è²¨åˆ°ä»˜æ¬¾</span>
              <span class="option-price">$250</span>
            </div>
            <div class="option-desc">å·²è³¼è²·æ´»é«”ï¼Œè²¨åˆ°ä»˜æ¬¾</div>
          </div>
          
          <div class="option-card" onclick="selectShipping('post-office', 100)">
            <div class="option-header">
              <span>ğŸ“® éƒµå±€/å¤§æ¦®ç‰©æµ - å™¨æå°ˆç”¨</span>
              <span class="option-price">$100</span>
            </div>
            <div class="option-desc">ç„¡è³¼è²·æ´»é«”ï¼Œåªæœ‰å™¨æ</div>
          </div>
        </div>
        
        <!-- Payment Method -->
        <div class="checkout-section">
          <h3>ğŸ’³ ä»˜æ¬¾æ–¹å¼</h3>
          
          <div class="payment-grid">
            <div class="payment-btn selected" onclick="selectPayment('linepay')">
              <div class="icon">ğŸ’š</div>
              <div class="name">LINE Pay</div>
            </div>
            <div class="payment-btn" onclick="selectPayment('atm')">
              <div class="icon">ğŸ¦</div>
              <div class="name">éŠ€è¡Œè½‰å¸³</div>
            </div>
            <div class="payment-btn" onclick="selectPayment('cod')">
              <div class="icon">ğŸ’µ</div>
              <div class="name">è²¨åˆ°ä»˜æ¬¾</div>
            </div>
            <div class="payment-btn" onclick="selectPayment('credit')">
              <div class="icon">ğŸ’³</div>
              <div class="name">ä¿¡ç”¨å¡</div>
            </div>
          </div>
          
          <div id="atm-info" style="display: none; margin-top: 15px; padding: 15px; background: #f8f9fa; border-radius: 10px;">
            <p style="margin-bottom: 10px;"><strong>éŠ€è¡Œè½‰å¸³è³‡è¨Šï¼š</strong></p>
            <p>éŠ€è¡Œä»£ç¢¼ï¼š808</p>
            <p>å¸³è™Ÿï¼š1234-5678-9012</p>
            <p>æˆ¶åï¼šAquarium Studio</p>
            <div class="form-group" style="margin-top: 15px;">
              <label>è½‰å¸³å¸³è™Ÿå¾Œ5ç¢¼ *</label>
              <input type="text" id="atm-last5" placeholder="è«‹è¼¸å…¥å¾Œ5ç¢¼" maxlength="5">
            </div>
          </div>
        </div>
        
        <!-- Order Summary -->
        <div class="checkout-section">
          <h3>ğŸ“‹ è¨‚å–®æ‘˜è¦</h3>
          
          <div class="order-summary-card">
            <h4>å•†å“é‡‘é¡</h4>
            <div id="order-items"></div>
          </div>
          
          <div class="order-summary-card">
            <div class="order-item-row">
              <span>å•†å“å°è¨ˆ</span>
              <span id="subtotal">$0</span>
            </div>
            <div class="order-item-row">
              <span>é‹è²»</span>
              <span id="shipping-fee">$0</span>
            </div>
            <div class="order-total-row">
              <span>è¨‚å–®ç¸½é‡‘é¡</span>
              <span id="order-total" style="color: #667eea;">$0</span>
            </div>
          </div>
        </div>
        
        <!-- Submit Button -->
        <button class="btn btn-primary btn-lg btn-block" onclick="submitOrder()" style="margin-top: 20px;">
          ğŸ’¬ ç¢ºèªè¨‚å–®ä¸¦é–‹å•Ÿ LINE
        </button>
      </div>
    </div>
  </section>

  <!-- Order Confirmation Modal -->
  <div id="order-modal" class="modal-overlay" style="display: none;">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title">âœ… è¨‚å–®å·²æˆç«‹</h3>
        <button class="modal-close" onclick="closeOrderModal()">&times;</button>
      </div>
      <div class="modal-body" id="order-modal-content"></div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-bottom">
        <p>&copy; 2026 Aquarium Studio. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <script src="js/app.js"></script>
  <script src="js/settings.js"></script>
  <script>
    // Taiwan districts data
    const taiwanDistricts = {
      'å°åŒ—å¸‚': ['ä¸­æ­£å€', 'å¤§åŒå€', 'ä¸­å±±å€', 'æ¾å±±å€', 'å¤§å®‰å€', 'è¬è¯å€', 'ä¿¡ç¾©å€', 'å£«æ—å€', 'åŒ—æŠ•å€', 'å…§æ¹–å€', 'å—æ¸¯å€', 'æ–‡å±±å€'],
      'æ–°åŒ—å¸‚': ['æ¿æ©‹å€', 'æ–°èŠå€', 'ä¸­å’Œå€', 'æ°¸å’Œå€', 'åœŸåŸå€', 'æ¨¹æ—å€', 'ä¸‰å³½å€', 'é¶¯æ­Œå€', 'ä¸‰é‡å€', 'è˜†æ´²å€', 'äº”è‚¡å€', 'æ³°å±±å€', 'æ—å£å€', 'æ·¡æ°´å€', 'æ±æ­¢å€', 'ç‘èŠ³å€', 'æ–°åº—å€', 'æ·±å‘å€', 'çŸ³ç¢‡å€', 'åªæ—å€', 'çƒä¾†å€'],
      'æ¡ƒåœ’å¸‚': ['æ¡ƒåœ’å€', 'ä¸­å£¢å€', 'å¹³é®å€', 'å…«å¾·å€', 'æ¥Šæ¢…å€', 'è˜†ç«¹å€', 'é¾œå±±å€', 'é¾æ½­å€', 'å¤§æºªå€', 'å¤§åœ’å€', 'è§€éŸ³å€', 'æ–°å±‹å€', 'æ¥Šæ¢…å€', 'å¯Œå²¡å€', 'å¾©èˆˆå€'],
      'å°ä¸­å¸‚': ['ä¸­å€', 'æ±å€', 'å—å€', 'è¥¿å€', 'åŒ—å€', 'åŒ—å±¯å€', 'è¥¿å±¯å€', 'å—å±¯å€', 'å¤ªå¹³å€', 'å¤§é‡Œå€', 'éœ§å³°å€', 'çƒæ—¥å€', 'è±åŸå€', 'åé‡Œå€', 'æ±å‹¢å€', 'çŸ³å²¡å€', 'æ–°ç¤¾å€', 'æ½­å­å€', 'å¤§é›…å€', 'ç¥å²¡å€', 'å¤§è‚šå€', 'æ²™é¹¿å€', 'é¾äº•å€', 'æ¢§æ£²å€', 'æ¸…æ°´å€', 'å¤§ç”²å€', 'å¤–åŸ”å€', 'å¤§å®‰å€'],
      'å°å—å¸‚': ['ä¸­è¥¿å€', 'æ±å€', 'å—å€', 'åŒ—å€', 'å®‰å¹³å€', 'å®‰å—å€', 'æ°¸åº·å€', 'æ­¸ä»å€', 'æ–°åŒ–å€', 'å·¦é®å€', 'ç‰äº•å€', 'æ¥ è¥¿å€', 'å—åŒ–å€', 'ä»å¾·å€', 'é—œå»Ÿå€', 'é¾å´å€', 'å®˜ç”°å€', 'éº»è±†å€', 'ä½³é‡Œå€', 'è¥¿æ¸¯å€', 'ä¸ƒè‚¡å€', 'å°‡è»å€', 'å­¸ç”²å€', 'åŒ—é–€å€', 'æ–°ç‡Ÿå€', 'å¾Œå£å€', 'ç™½æ²³å€', 'æ±å±±å€', 'å…­ç”²å€', 'ä¸‹ç‡Ÿå€', 'æŸ³ç‡Ÿå€', 'é¹½æ°´å€', 'å–„åŒ–å€', 'å¤§å…§å€', 'å±±ä¸Šå€', 'æ–°å¸‚å€', 'å®‰å®šå€'],
      'é«˜é›„å¸‚': ['æ–°èˆˆå€', 'å‰é‡‘å€', 'è‹“é›…å€', 'é¹½åŸ•å€', 'é¼“å±±å€', 'æ——æ´¥å€', 'å‰é®å€', 'ä¸‰æ°‘å€', 'å·¦ç‡Ÿå€', 'æ¥ æ¢“å€', 'å°æ¸¯å€', 'é³³å±±å€', 'æ—åœ’å€', 'å¤§å¯®å€', 'å¤§æ¨¹å€', 'å¤§ç¤¾å€', 'ä»æ­¦å€', 'é³¥æ¾å€', 'å²¡å±±å€', 'æ©‹é ­å€', 'ç‡•å·¢å€', 'ç”°å¯®å€', 'é˜¿è“®å€', 'è·¯ç«¹å€', 'æ¹–å…§å€', 'èŒ„è£å€', 'æ°¸å®‰å€', 'å½Œé™€å€', 'æ¢“å®˜å€', 'æ——å±±å€', 'ç¾æ¿ƒå€', 'å…­é¾œå€', 'ç”²ä»™å€', 'æ‰æ—å€', 'å…§é–€å€', 'èŒ‚æ—å€', 'æ¡ƒæºå€', 'é‚£ç‘ªå¤å€'],
      'åŸºéš†å¸‚': ['ä¸­æ­£å€', 'ä¸ƒå µå€', 'æš–æš–å€', 'ä»æ„›å€', 'ä¸­å±±å€', 'å®‰æ¨‚å€', 'ä¿¡ç¾©å€'],
      'æ–°ç«¹å¸‚': ['æ±å€', 'åŒ—å€', 'é¦™å±±å€'],
      'å˜‰ç¾©å¸‚': ['æ±å€', 'è¥¿å€'],
      'æ–°ç«¹ç¸£': ['ç«¹åŒ—å¸‚', 'ç«¹æ±é®', 'æ–°åŸ”é®', 'é—œè¥¿é®', 'æ¹–å£é„‰', 'æ–°è±é„‰', 'èŠæ—é„‰', 'æ©«å±±é„‰', 'åŒ—åŸ”é„‰', 'å³¨çœ‰é„‰', 'å¯¶å±±é„‰', 'å°–çŸ³é„‰', 'äº”å³°é„‰'],
      'è‹—æ —ç¸£': ['è‹—æ —å¸‚', 'é ­ä»½å¸‚', 'è‹‘è£¡é®', 'é€šéœ„é®', 'ç«¹å—é®', 'å¾Œé¾é®', 'å“è˜­é®', 'å¤§æ¹–é„‰', 'å…¬é¤¨é„‰', 'éŠ…é‘¼é„‰', 'å—åº„é„‰', 'é ­å±‹é„‰', 'ä¸‰ç¾©é„‰', 'è¥¿æ¹–é„‰', 'é€ æ©‹é„‰', 'ä¸‰ç£é„‰', 'ç…æ½­é„‰', 'æ³°å®‰é„‰'],
      'å½°åŒ–ç¸£': ['å½°åŒ–å¸‚', 'å“¡æ—å¸‚', 'å’Œç¾é®', 'é¹¿æ¸¯é®', 'æºªæ¹–é®', 'äºŒæ—é®', 'ç”°ä¸­é®', 'åŒ—æ–—é®', 'èŠ±å£‡é„‰', 'èŠ¬åœ’é„‰', 'å¤§æ‘é„‰', 'æ°¸é–é„‰', 'ä¼¸æ¸¯é„‰', 'ç·šè¥¿é„‰', 'ç§€æ°´é„‰', 'åŸ”å¿ƒé„‰', 'åŸ”é¹½é„‰', 'å¤§åŸä¹¡', 'èŠ³è‹‘é„‰', 'ç«¹å¡˜é„‰', 'åŸ¤é ­é„‰', 'äºŒæ°´é„‰', 'ç”°å°¾é„‰', 'æºªå·é„‰'],
      'å—æŠ•ç¸£': ['å—æŠ•å¸‚', 'åŸ”é‡Œé®', 'è‰å±¯é®', 'ç«¹å±±é®', 'é›†é›†é®', 'æ°´é‡Œé„‰', 'é­šæ± é„‰', 'ä¿¡ç¾©é„‰', 'ä»æ„›é„‰', 'åé–“é„‰', 'ä¸­å¯®é„‰', 'é¹¿è°·é„‰'],
      'é›²æ—ç¸£': ['æ–—å…­å¸‚', 'æ–—å—é®', 'è™å°¾é®', 'è¥¿èºé®', 'åœŸåº«é®', 'åŒ—æ¸¯é®', 'è¿æ¡é„‰', 'æ—å…§é„‰', 'å¤å‘é„‰', 'å¤§åŸ¤é„‰', 'è¡¨å½°é„‰', 'äºŒå´™é„‰', 'å´™èƒŒé„‰', 'éº¥å¯®é„‰', 'æ±å‹¢é„‰', 'è¤’å¿ é„‰', 'å°è¥¿é„‰', 'å…ƒé•·é„‰', 'å››æ¹–é„‰', 'å£æ¹–é„‰', 'æ°´æ—é„‰'],
      'å±æ±ç¸£': ['å±æ±å¸‚', 'æ½®å·é®', 'æ±æ¸¯é®', 'æ†æ˜¥é®', 'è¬ä¸¹é„‰', 'é•·æ²»é„‰', 'éºŸæ´›é„‰', 'ä¹å¦‚é„‰', 'é‡Œæ¸¯é„‰', 'é¹½åŸ”é„‰', 'é«˜æ¨¹é„‰', 'è¬å·’é„‰', 'å…§åŸ”é„‰', 'ç«¹ç”°é„‰', 'æ–°åŸ¤é„‰', 'æ‹å¯®é„‰', 'æ–°åœ’é„‰', 'å´é ‚é„‰', 'æ—é‚Šé„‰', 'å—å·é„‰', 'ä½³å†¬é„‰', 'ç‰çƒé„‰', 'è»ŠåŸé„‰', 'æ»¿å·é„‰', 'æ‹å±±é„‰', 'ä¸‰åœ°é–€é„‰', 'éœ§å°é„‰', 'ç‘ªå®¶é„‰', 'æ³°æ­¦é„‰', 'ä¾†ç¾©é„‰', 'æ˜¥æ—¥é„‰', 'ç…å­é„‰', 'ç‰¡ä¸¹é„‰'],
      'å®œè˜­ç¸£': ['å®œè˜­å¸‚', 'ç¾…æ±é®', 'è˜‡æ¾³é®', 'é ­åŸé®', 'ç¤æºªé„‰', 'å£¯åœé„‰', 'å“¡å±±é„‰', 'å†¬å±±é„‰', 'äº”çµé„‰', 'ä¸‰æ˜Ÿé„‰', 'å¤§åŒé„‰', 'å—æ¾³é„‰'],
      'èŠ±è“®ç¸£': ['èŠ±è“®å¸‚', 'é³³æ—é®', 'ç‰é‡Œé®', 'æ–°åŸé„‰', 'å‰å®‰é„‰', 'å£½è±é„‰', 'ç§€æ—é„‰', 'æ–°åŸä¹¡', 'ç‘ç©—é„‰', 'è¬æ¦®é„‰', 'å…‰å¾©é„‰', 'è±æ¿±é„‰', 'å“æºªé„‰'],
      'å°æ±ç¸£': ['å°æ±å¸‚', 'æˆåŠŸé®', 'é—œå±±é®', 'å‘å—é„‰', 'é¹¿é‡é„‰', 'æ± ä¸Šé„‰', 'æ±æ²³é„‰', 'é•·æ¿±é„‰', 'å¤ªéº»é‡Œé„‰', 'é‡‘å³°é„‰', 'å¤§æ­¦é„‰', 'ç¶ å³¶é„‰', 'æµ·ç«¯é„‰', 'å»¶å¹³é„‰', 'é”ä»é„‰', 'è˜­å¶¼é„‰'],
      'æ¾æ¹–ç¸£': ['é¦¬å…¬å¸‚', 'æ¹–è¥¿é„‰', 'ç™½æ²™é„‰', 'è¥¿å¶¼é„‰', 'æœ›å®‰é„‰', 'ä¸ƒç¾é„‰'],
      'é‡‘é–€ç¸£': ['é‡‘åŸé®', 'é‡‘æ¹–é®', 'é‡‘æ²™é®', 'é‡‘å¯§é„‰', 'çƒˆå¶¼é„‰', 'çƒåµé„‰'],
      'é€£æ±Ÿç¸£': ['å—ç«¿é„‰', 'åŒ—ç«¿é„‰', 'è’å…‰é„‰', 'æ±å¼•é„‰']
    };
    
    const zipcodes = {
      'å°åŒ—å¸‚': '100', 'æ–°åŒ—å¸‚': '220', 'æ¡ƒåœ’å¸‚': '330', 'å°ä¸­å¸‚': '400', 'å°å—å¸‚': '700', 'é«˜é›„å¸‚': '800',
      'åŸºéš†å¸‚': '200', 'æ–°ç«¹å¸‚': '300', 'å˜‰ç¾©å¸‚': '600'
    };
    
    let selectedShipping = { method: 'blackcat-prepay', fee: 200 };
    let selectedPayment = 'linepay';
    
    function toggleMobileMenu() {
      const navLinks = document.querySelector('.nav-links');
      const menuBtn = document.querySelector('.mobile-menu-btn');
      navLinks.classList.toggle('active');
      menuBtn.textContent = navLinks.classList.contains('active') ? 'âœ•' : 'â˜°';
    }
    
    function updateDistricts() {
      const city = document.getElementById('customer-city').value;
      const districtSelect = document.getElementById('customer-district');
      const zipcodeInput = document.getElementById('customer-zipcode');
      
      districtSelect.innerHTML = '<option value="">é¸æ“‡é„‰é®å¸‚å€</option>';
      
      if (city && taiwanDistricts[city]) {
        taiwanDistricts[city].forEach(district => {
          const option = document.createElement('option');
          option.value = district;
          option.textContent = district;
          districtSelect.appendChild(option);
        });
        
        // Set zipcode (approximate)
        if (zipcodes[city]) {
          zipcodeInput.value = zipcodes[city];
        }
      }
    }
    
    function selectShipping(method, fee) {
      selectedShipping = { method, fee };
      
      document.querySelectorAll('.checkout-section .option-card').forEach(card => {
        card.classList.remove('selected');
      });
      
      event.currentTarget.classList.add('selected');
      
      // Update shipping fee display
      document.getElementById('shipping-fee').textContent = '$' + fee;
      updateTotal();
    }
    
    function selectPayment(method) {
      selectedPayment = method;
      
      document.querySelectorAll('.payment-btn').forEach(btn => {
        btn.classList.remove('selected');
      });
      
      event.currentTarget.classList.add('selected');
      
      // Show/hide ATM info
      const atmInfo = document.getElementById('atm-info');
      if (method === 'atm') {
        atmInfo.style.display = 'block';
      } else {
        atmInfo.style.display = 'none';
      }
    }
    
    function updateTotal() {
      const cart = AquariumApp.getCart();
      const subtotal = AquariumApp.getCartTotal();
      const total = subtotal + selectedShipping.fee;
      
      document.getElementById('subtotal').textContent = '$' + subtotal;
      document.getElementById('order-total').textContent = '$' + total;
    }
    
    function renderOrderItems() {
      const cart = AquariumApp.getCart();
      const container = document.getElementById('order-items');
      const itemsContainer = document.getElementById('checkout-items');
      
      if (cart.length === 0) {
        container.innerHTML = '<p style="text-align: center; color: #999;">è³¼ç‰©è»Šæ˜¯ç©ºçš„</p>';
        itemsContainer.innerHTML = '<p style="text-align: center; color: #999;">è³¼ç‰©è»Šæ˜¯ç©ºçš„</p>';
        return;
      }
      
      const html = cart.map(item => `
        <div class="order-item-row">
          <span>${item.name} x ${item.quantity}</span>
          <span>$${item.price * item.quantity}</span>
        </div>
      `).join('');
      
      container.innerHTML = html;
      itemsContainer.innerHTML = cart.map(item => `
        <div style="display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #eee;">
          <div>
            <strong>${item.name}</strong>
            <div style="font-size: 0.85rem; color: #666;">æ•¸é‡: ${item.quantity}</div>
          </div>
          <span style="font-weight: bold;">$${item.price * item.quantity}</span>
        </div>
      `).join('');
      
      updateTotal();
    }
    
    function submitOrder() {
      // Check if LINE has been added
      const hasAddedLine = localStorage.getItem('lineAdded_yasonok02061') === 'true';
      if (!hasAddedLine) {
        AquariumApp.showToast('è«‹å…ˆåŠ å…¥ LINE å¥½å‹æ‰èƒ½çµå¸³ï¼', 'warning');
        window.location.href = 'shop.html';
        return;
      }
      
      const name = document.getElementById('customer-name').value;
      const phone = document.getElementById('customer-phone').value;
      const city = document.getElementById('customer-city').value;
      const district = document.getElementById('customer-district').value;
      const address = document.getElementById('customer-address').value;
      const lineId = document.getElementById('customer-lineid').value;
      
      if (!name || !phone || !city || !district || !address) {
        AquariumApp.showToast('è«‹å¡«å¯«å®Œæ•´è³‡æ–™', 'error');
        return;
      }
      
      const fullAddress = city + district + address;
      
      const customerInfo = {
        name,
        phone,
        address: fullAddress,
        lineId,
        shippingMethod: selectedShipping.method,
        paymentMethod: selectedPayment,
        note: document.getElementById('customer-note')?.value || ''
      };
      
      const order = AquariumApp.createOrder(customerInfo);
      
      if (order) {
        // Save to member if logged in
        if (typeof MemberSystem !== 'undefined' && MemberSystem.isLoggedIn()) {
          MemberSystem.saveOrder(order, MemberSystem.getCurrentUser().uid);
        }
        
        showOrderConfirmation(order);
      } else {
        AquariumApp.showToast('è¨‚å–®å»ºç«‹å¤±æ•—', 'error');
      }
    }
    
    function showOrderConfirmation(order) {
      const modal = document.getElementById('order-modal');
      const content = document.getElementById('order-modal-content');
      
      const shippingNames = {
        'blackcat-prepay': 'é»‘è²“å®…æ€¥ä¾¿ (å…ˆä»˜æ¬¾)',
        'blackcat-cod': 'é»‘è²“å®…æ€¥ä¾¿ (è²¨åˆ°ä»˜æ¬¾)',
        'post-office': 'éƒµå±€/å¤§æ¦®ç‰©æµ'
      };
      
      const paymentNames = {
        'linepay': 'LINE Pay',
        'atm': 'éŠ€è¡Œè½‰å¸³',
        'cod': 'è²¨åˆ°ä»˜æ¬¾',
        'credit': 'ä¿¡ç”¨å¡'
      };
      
      // Get LINE ID from settings
      let lineId = 'yasonok02061';
      if (typeof SiteSettings !== 'undefined') {
        const settings = SiteSettings.load();
        lineId = settings.contact.lineId.replace('@', '');
      }
      
      // Generate order message
      const orderMessage = `
ğŸŸ Aquarium Studio è¨‚å–®

è¨‚å–®ç·¨è™Ÿ: ${order.id}
å§“å: ${order.customer.name}
é›»è©±: ${order.customer.phone}
åœ°å€: ${order.customer.address}
é…é€: ${shippingNames[order.customer.shippingMethod]}
ä»˜æ¬¾: ${paymentNames[order.customer.paymentMethod]}

å•†å“:
${order.items.map(item => `- ${item.name} x ${item.quantity} = $${item.price * item.quantity}`).join('\n')}

ç¸½é‡‘é¡: $${order.total}
`;
      
      content.innerHTML = `
        <div style="text-align: center; padding: 20px;">
          <div style="font-size: 4rem; margin-bottom: 20px;">âœ…</div>
          <h2 style="color: #198754; margin-bottom: 15px;">è¨‚å–®å·²æˆç«‹ï¼</h2>
          <p style="color: #6c757d; margin-bottom: 10px;">è¨‚å–®ç·¨è™Ÿ: <strong>${order.id}</strong></p>
          
          <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; text-align: left; margin: 20px 0;">
            <p><strong>å§“å:</strong> ${order.customer.name}</p>
            <p><strong>é›»è©±:</strong> ${order.customer.phone}</p>
            <p><strong>åœ°å€:</strong> ${order.customer.address}</p>
            <p><strong>é…é€:</strong> ${shippingNames[order.customer.shippingMethod]}</p>
            <p><strong>ä»˜æ¬¾:</strong> ${paymentNames[order.customer.paymentMethod]}</p>
          </div>
          
          <p style="font-size: 1.2rem; font-weight: bold; margin: 20px 0;">
            ç¸½é‡‘é¡: <span style="color: #667eea;">$${order.total}</span>
          </p>
          
          <div style="display: flex; flex-direction: column; gap: 10px; margin: 20px 0;">
            <button onclick="contactViaLine('${lineId}', \`${orderMessage}\`)" class="btn btn-primary btn-lg" style="background: #06c755;">
              ğŸ’¬ åŠ å…¥ LINE è¯ç¹«ç®¡ç†å“¡
            </button>
            <button onclick="copyOrderInfo(\`${orderMessage}\`)" class="btn btn-secondary btn-lg">
              ğŸ“‹ è¤‡è£½è¨‚å–®è³‡è¨Š
            </button>
          </div>
          
          <p style="color: #6c757d; font-size: 0.9rem; margin-bottom: 20px;">
            é»æ“Šä¸Šæ–¹æŒ‰éˆ•è¯ç¹«ç®¡ç†å“¡ç¢ºèªè¨‚å–®
          </p>
          
          <a href="shop.html" class="btn btn-outline btn-lg" style="margin-right: 10px;">ç¹¼çºŒè³¼ç‰©</a>
          <button onclick="closeOrderModal()" class="btn btn-secondary btn-lg">é—œé–‰</button>
        </div>
      `;
      
      modal.style.display = 'flex';
    }
    
    function contactViaLine(lineId, message) {
      // Copy message to clipboard
      copyOrderInfo(message);
      
      // Open LINE
      const lineUrl = `https://line.me/ti/p/@${lineId}`;
      window.open(lineUrl, '_blank');
      
      AquariumApp.showToast('è¨‚å–®è³‡è¨Šå·²è¤‡è£½ï¼Œè«‹åœ¨ LINE ä¸­è²¼ä¸Šä¸¦å‚³é€', 'success');
    }
    
    function copyOrderInfo(message) {
      navigator.clipboard.writeText(message.trim()).then(() => {
        AquariumApp.showToast('è¨‚å–®è³‡è¨Šå·²è¤‡è£½åˆ°å‰ªè²¼ç°¿', 'success');
      }).catch(() => {
        // Fallback for older browsers
        const textarea = document.createElement('textarea');
        textarea.value = message.trim();
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand('copy');
        document.body.removeChild(textarea);
        AquariumApp.showToast('è¨‚å–®è³‡è¨Šå·²è¤‡è£½åˆ°å‰ªè²¼ç°¿', 'success');
      });
    }
    
    function closeOrderModal() {
      document.getElementById('order-modal').style.display = 'none';
    }
    
    // Load site name
    function loadSiteName() {
      if (typeof SiteSettings !== 'undefined') {
        const settings = SiteSettings.load();
        const logoText = document.querySelector('.logo-text');
        if (logoText) {
          logoText.innerHTML = settings.site.name;
        }
      }
    }
    
    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
      renderOrderItems();
      loadSiteName();
    });
  </script>
</body>
</html>