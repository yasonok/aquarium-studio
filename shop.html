<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å•†åº— - Aquarium Studio</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <!-- Loading State -->
  <div id="loading" style="display: flex; justify-content: center; align-items: center; min-height: 100vh;">
    <p>è¼‰å…¥ä¸­...</p>
  </div>

  <!-- LINE Add Friend Page (shown if not added) -->
  <div id="line-page" style="display: none;">
    <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; text-align: center; padding: 20px; background: linear-gradient(135deg, #06c755 0%, #00b44a 100%); color: white;">
      <h1 style="font-size: 2rem; margin-bottom: 20px;">ğŸ’š åŠ å…¥ LINE å¥½å‹</h1>
      <p style="font-size: 1.1rem; margin-bottom: 30px; opacity: 0.9;">è«‹å…ˆåŠ å…¥ LINE å¥½å‹æ‰èƒ½è³¼è²·å•†å“</p>
      <a href="https://line.me/ti/p/@yasonok02061" class="btn btn-light" style="background: white; color: #06c755; padding: 15px 40px; border-radius: 50px; font-size: 1.2rem; font-weight: bold;">
        ğŸ“± åŠ å…¥ LINE å¥½å‹
      </a>
      <button onclick="confirmAdded()" style="margin-top: 20px; background: none; border: 2px solid white; color: white; padding: 10px 30px; border-radius: 25px; cursor: pointer;">
        âœ… æˆ‘å·²åŠ å…¥å¥½å‹
      </button>
    </div>
  </div>

  <!-- Shop Page (shown if added) -->
  <div id="shop-page" style="display: none;">
    <!-- Header -->
    <header class="header">
      <div class="container">
        <div class="header-inner">
          <a href="index.html" class="logo">
            <span class="logo-icon">ğŸŸ</span>
            <span class="logo-text">Aquarium <span>Studio</span></span>
          </a>
          
          <nav class="nav-links">
            <a href="index.html">é¦–é </a>
            <a href="shop.html" class="active">å•†åº—</a>
            <a href="cart.html" class="cart-icon">
              ğŸ›’ è³¼ç‰©è»Š
              <span class="cart-badge" id="cartCount">0</span>
            </a>
            <a href="admin.html">ç®¡ç†</a>
          </nav>
        </div>
      </div>
    </header>

    <!-- Shop Section -->
    <section class="section">
      <div class="container">
        <div class="section-header">
          <h2 id="shopTitle">ğŸ  å­”é›€é­šå•†å“</h2>
          <p>é¸æ“‡æ‚¨å–œæ„›çš„å­”é›€é­šå“ç¨®</p>
        </div>
        
        <!-- Product Controls -->
        <div class="product-controls">
          <div class="filter-buttons">
            <button class="filter-btn active" onclick="filterProducts('all')" data-category="all">å…¨éƒ¨</button>
            <button class="filter-btn" onclick="filterProducts('ç´…è‰²ç³»')" data-category="ç´…è‰²ç³»">ğŸ”´ ç´…è‰²ç³»</button>
            <button class="filter-btn" onclick="filterProducts('é»‘è‰²ç³»')" data-category="é»‘è‰²ç³»">âš« é»‘è‰²ç³»</button>
            <button class="filter-btn" onclick="filterProducts('ç‰¹æ®Šç³»')" data-category="ç‰¹æ®Šç³»">ğŸŒˆ ç‰¹æ®Šç³»</button>
            <button class="filter-btn" onclick="filterProducts('ç¨€æœ‰ç³»')" data-category="ç¨€æœ‰ç³»">ğŸ’ ç¨€æœ‰ç³»</button>
            <button class="filter-btn" onclick="filterProducts('è—è‰²ç³»')" data-category="è—è‰²ç³»">ğŸ”µ è—è‰²ç³»</button>
            <button class="filter-btn" onclick="filterProducts('é‡‘è‰²ç³»')" data-category="é‡‘è‰²ç³»">ğŸŸ¡ é‡‘è‰²ç³»</button>
          </div>
          
          <div class="search-sort">
            <select id="sort-filter" onchange="sortProducts()">
              <option value="default">ğŸ”„ é è¨­æ’åº</option>
              <option value="price-asc">ğŸ’° åƒ¹æ ¼ï¼šä½åˆ°é«˜</option>
              <option value="price-desc">ğŸ’° åƒ¹æ ¼ï¼šé«˜åˆ°ä½</option>
              <option value="name-asc">ğŸ“ åç¨±ï¼šA-Z</option>
              <option value="name-desc">ğŸ“ åç¨±ï¼šZ-A</option>
            </select>
          </div>
        </div>
        
        <!-- Product Grid -->
        <div class="product-grid" id="product-grid">
          <div class="spinner"></div>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
      <div class="container">
        <div class="footer-grid">
          <div class="footer-section">
            <h3>ğŸŸ Aquarium Studio</h3>
            <p>å°ˆæ¥­å­”é›€é­šé¤Šæ®–èˆ‡è²©å”®</p>
          </div>
          <div class="footer-section">
            <h3>ğŸ“ è¯çµ¡æˆ‘å€‘</h3>
            <p id="footer-lineId">LINE: @yasonok02061</p>
            <p id="footer-phone">é›»è©±: (02) 1234-5678</p>
          </div>
          <div class="footer-section">
            <h3>ğŸ”— å¿«é€Ÿé€£çµ</h3>
            <a href="index.html">é¦–é </a>
            <a href="shop.html">å•†åº—</a>
            <a href="cart.html">è³¼ç‰©è»Š</a>
          </div>
        </div>
        <div class="footer-bottom">
          <p>&copy; 2026 Aquarium Studio. All rights reserved.</p>
        </div>
      </div>
    </footer>
  </div>

  <script src="js/app.js"></script>
  <script src="js/settings.js"></script>
  <script>
    const lineId = 'yasonok02061';
    let currentCategory = 'all';
    let currentSort = 'default';

    function confirmAdded() {
      localStorage.setItem('lineAdded_' + lineId, 'true');
      location.reload();
    }

    function showLinePage() {
      document.getElementById('loading').style.display = 'none';
      document.getElementById('line-page').style.display = 'block';
      document.getElementById('shop-page').style.display = 'none';
    }

    function showShopPage() {
      document.getElementById('loading').style.display = 'none';
      document.getElementById('line-page').style.display = 'none';
      document.getElementById('shop-page').style.display = 'block';
    }

    function renderProducts(category = 'all', sort = 'default') {
      const grid = document.getElementById('product-grid');
      const products = AquariumApp.getProducts();
      let filtered = category === 'all' ? products : products.filter(p => p.category === category);
      
      switch(sort) {
        case 'price-asc': filtered.sort((a, b) => a.price - b.price); break;
        case 'price-desc': filtered.sort((a, b) => b.price - a.price); break;
        case 'name-asc': filtered.sort((a, b) => a.name.localeCompare(b.name)); break;
        case 'name-desc': filtered.sort((a, b) => b.name.localeCompare(a.name)); break;
      }
      
      if (filtered.length === 0) {
        grid.innerHTML = '<div class="empty-state" style="grid-column: 1/-1;"><div class="empty-state-icon">ğŸŸ</div><h3>æ­¤åˆ†é¡æš«ç„¡å•†å“</h3><p>æ•¬è«‹æœŸå¾…ï¼</p></div>';
        return;
      }
      
      grid.innerHTML = filtered.map(product => `
        <div class="product-card">
          <div class="product-image-wrapper">
            <img src="${product.image || 'images/products/default-guppy.svg'}" alt="${product.name}" class="product-image" onerror="this.src='images/products/default-guppy.svg'">
            <span class="product-badge">${product.category}</span>
          </div>
          <div class="product-info">
            <h3 class="product-name">${product.name}</h3>
            <p class="product-description">${product.description}</p>
            <div class="product-meta">
              <span class="product-price">$${product.price}</span>
              <span class="product-stock">åº«å­˜ ${product.stock}</span>
            </div>
            <button class="btn btn-primary" onclick="AquariumApp.addToCart(${product.id}, 1)" style="width: 100%;">ğŸ›’ åŠ å…¥è³¼ç‰©è»Š</button>
          </div>
        </div>
      `).join('');
    }

    function filterProducts(category) {
      currentCategory = category;
      document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.toggle('active', btn.dataset.category === category));
      renderProducts(category, currentSort);
    }

    function sortProducts() {
      currentSort = document.getElementById('sort-filter').value;
      renderProducts(currentCategory, currentSort);
    }

    function updateCartCount() {
      const cart = AquariumApp.getCart();
      const countEl = document.getElementById('cartCount');
      if (countEl) countEl.textContent = cart.length;
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
      const hasAddedLine = localStorage.getItem('lineAdded_' + lineId) === 'true';
      
      if (hasAddedLine) {
        showShopPage();
        updateCartCount();
        renderProducts();
      } else {
        showLinePage();
      }
    });
  </script>
</body>
</html>
